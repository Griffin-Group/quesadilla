
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://Griffin-Group.github.io/quesadilla/v0.0.3/tutorial/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../reference/example/generate_kpoints/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Tutorial - Quesadilla</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/code_select.css">
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tutorial" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Quesadilla" class="md-header__button md-logo" aria-label="Quesadilla" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Quesadilla
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tutorial
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Griffin-Group/quesadilla/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Griffin-Group/quesadilla
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Quesadilla" class="md-nav__button md-logo" aria-label="Quesadilla" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Quesadilla
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Griffin-Group/quesadilla/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Griffin-Group/quesadilla
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-generate-supercells-with-displacements" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Generate supercells with displacements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-run-the-dft-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: run the DFT calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-generate-the-force-sets-force_sets" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: generate the force sets (FORCE_SETS)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-generate-the-force-constants" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: generate the force constants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Code Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    example
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            example
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/example/generate_kpoints/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generate_kpoints
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../reference/quesadilla/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    quesadilla
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            quesadilla
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/quesadilla/cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/quesadilla/dynmat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dynmat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/quesadilla/supercells/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    supercells
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/quesadilla/symmetries/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    symmetries
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/quesadilla/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/tools/run_f2py/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    run_f2py
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#step-1-generate-supercells-with-displacements" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Generate supercells with displacements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-2-run-the-dft-calculations" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: run the DFT calculations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-3-generate-the-force-sets-force_sets" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: generate the force sets (FORCE_SETS)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#step-4-generate-the-force-constants" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: generate the force constants
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="tutorial">Tutorial</h1>
<p>In this short tutorial, we will work through the process of computing the phonon dispersion of Silicon on a <span class="arithmatex">\(4 \times 4 \times 4\)</span> <span class="arithmatex">\(q\)</span>-grid using the nondiagonal supercell (NDSC) method. We will use VASP as the force calculator, but the process is similar for every other DFT code supported by phonopy. We assume the reader is already familiar with phonopy and the basics of phonon calculations. </p>
<p>The files for this tutorial are available in the <code>example</code> directory of the Quesadilla repository.</p>
<h2 id="step-1-generate-supercells-with-displacements">Step 1: Generate supercells with displacements</h2>
<p>The first step is always to generate supercells with displacements, and the Quesadilla command line interface is very similar to phonopy's. With phonopy, you would run something like <code>phonopy -d --dim 4 4 4</code>, perhaps with extra arguments (e.g., <code>phonopy --qe -d --dim 4 4 4 -c pw.in</code> for QE). Quesadilla supports all force calculators suppported by phonopy, as well as all the arguments used to control displacements (e.g., <code>--pm</code>, <code>--trigonal</code>, etc.)</p>
<p>To generate NDSCs, you can run the exact same command you'd want to run with <code>phonopy</code>, but replace <code>phonopy</code> with <code>quesadilla</code>:</p>
<p><div class="language-bash highlight"><pre><span></span><code><span class="c1"># Assumes you use VASP and POSCAR is in current directory</span>
quesadilla<span class="w"> </span>-d<span class="w"> </span>--dim<span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
</code></pre></div>
with output
<div class="language-text highlight"><pre><span></span><code>Standard primitive cell written to PPOSCAR
We have 8 q-points in IBZ necessitating 8 supercells with total size  25
After minimization, we only need 5 supercells with total size  20
Supercells written to quesadilla.toml
Warning: Point group symmetries of supercell and primitivecell are different.
Nondiagonal supercell 1 needs 2 displacements.
Nondiagonal supercell 2 needs 2 displacements.
Nondiagonal supercell 3 needs 2 displacements.
Nondiagonal supercell 4 needs 4 displacements.
Nondiagonal supercell 5 needs 2 displacements.
</code></pre></div>
You can ignore the point group warnings, see <a href="https://github.com/Griffin-Group/quesadilla/issues/19">this issue</a></p>
<p>The directory structure after running this command should automatically look like this:</p>
<div class="language-text highlight"><pre><span></span><code>.
├── POSCAR
├── PPOSCAR
├── quesadilla.toml
├── sc-001
│   ├── POSCAR
│   ├── POSCAR-001
│   ├── POSCAR-002
│   ├── SPOSCAR
│   └── phonopy_disp.yaml
├── sc-002
│   ├── POSCAR
│   ├── POSCAR-001
│   ├── POSCAR-002
│   ├── SPOSCAR
│   └── phonopy_disp.yaml
├── sc-003
│   ├── POSCAR
│   ├── POSCAR-001
│   ├── POSCAR-002
│   ├── SPOSCAR
│   └── phonopy_disp.yaml
├── sc-004
│   ├── POSCAR
│   ├── POSCAR-001
│   ├── POSCAR-002
│   ├── POSCAR-003
│   ├── POSCAR-004
│   ├── SPOSCAR
│   └── phonopy_disp.yaml
└── sc-005
    ├── POSCAR
    ├── POSCAR-001
    ├── POSCAR-002
    ├── SPOSCAR
    └── phonopy_disp.yaml
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">What Queasdilla is doing under the hood</p>
<p>In a conventional <code>phonopy</code> calculation, <code>phonopy -d --dim 4 4 4</code> would have produced a pristine 4x4x4 supercell file (e.g., <code>SPOSCAR</code>), some supercells with displacements (e.g., <code>POSCAR-00{1,2,3...}</code>) and a <code>phonopy_disp.yaml</code> in the current directory. With quesadilla, it's a little more involved. Under the hood, quesadilla is doing the following:</p>
<ol>
<li>First, <code>quesadilla</code> will find a standard primitive cell. This is similar to running <code>phonopy --symmetry</code>. This standard primitive cell is what will be used to build the nondiagonal supercell, and will be saved in a file <code>PPOSCAR</code> in the current directory.</li>
<li>Next, quesadilla will figure out the minimum number of nondiagonal supercells necessary to span the 4x4x4 q-grid, build them, and then Minkowski reduce them. These files will be placed in the directories <code>sc-{001,002,...}</code>, each corresponding to a nondiagonal supercell. Each NDSC will be in, e.g., the <code>sc-*/SPOSCAR</code> file for VASP. The standard primitive file will also be placed in these directories as <code>POSCAR</code></li>
<li>Next, quesadilla will generate the displacemnts in each of these supercells, producing the files <code>sc-*/POSCAR-*</code>. This would be similar to running <code>phonopy -d --dim &lt;ndsc matrix&gt;</code> on every single supercell. Each <code>sc-*</code> folder will also have a <code>phonopy_disp.yaml</code> file, which can be used for debugging if necessary, and will be read later when creating the force sets.</li>
<li>Finally, a file <code>quesadilla.toml</code> will be written in the current, which contains all the information about the supercells and which <span class="arithmatex">\(q\)</span>-points they are commensurate with. All subsequent commands will read this file.</li>
</ol>
</div>
<div class="admonition question">
<p class="admonition-title">Why so many displacements?</p>
<p>You'll notice that the 5 nondiagonal supercells have 2 displacements each, except for the 4th supercell, which has 4 displacements. If you run <code>phonopy -d --dim 4 4 4</code>, you'll only get one supercell with displacement. This is because the nondiagonal supercells have lower symmetry than diagonal supercells, so you need more displacements to get the force constant matrix. For Si on a <span class="arithmatex">\(4 \times 4 \times 4\)</span> <span class="arithmatex">\(q\)</span>-grid, a standard diagonal supercell calculation would require 1 DFT calcualtion for a supercell with 128 atoms, while the NDSC method requires a total of 12 DFT calculations for supercells with 8 atoms each. </p>
</div>
<h2 id="step-2-run-the-dft-calculations">Step 2: run the DFT calculations</h2>
<p>As usual with <code>phonopy</code>, we now have to run the DFT calculations on the supercells with the displacements. We will place each <code>POSCAR-xxx</code> in a directory <code>disp-xxx</code> and run the calculation there (e.g., <code>POSCAR-002</code> should go in a directory <code>disp-002</code>). While this directory structure is optional for phonopy, it is mandatory for quesadilla. This needs to be repeated for every single supercell (i.e., for each <code>sc-*</code> directory). Optionally, the forces in the pristine supercell can also be calculated so they can be subtracted from the force sets in the next step. If this is desired, the pristine supercell calculation (e.g., the <code>SPOSCAR</code> file) should be run in the <code>disp-000</code> folder.</p>
<div class="admonition warning">
<p class="admonition-title">Be careful with <span class="arithmatex">\(k\)</span>-points!</p>
<p>With diagonal supercells, it's easy to choose the <span class="arithmatex">\(k\)</span>-points for each DFT calculation in the supercell. For example, if your primitive cell was converged with an <span class="arithmatex">\(8 \times 8 \times 8\)</span> <span class="arithmatex">\(k\)</span>-grid, then a <span class="arithmatex">\(4 \times 4 \times 4\)</span> supercell would have the same <span class="arithmatex">\(k\)</span>-point density with a <span class="arithmatex">\(2 \times 2 \times 2\)</span> grid instead.</p>
<p>The situation is a little trickier with NDSCs and the <span class="arithmatex">\(k\)</span>-grid used for each NDSC will be different. The easiest option is to use an external tool to generate necessary grid that maintains the desired <span class="arithmatex">\(k\)</span>-point spacing. The script <a href="https://github.com/Griffin-Group/quesadilla/blob/main/example/generate_kpoints.py"><code>example/generate_kpoints.py</code></a> shows how to do this with <code>pymatgen</code>. </p>
<p>Also note that, given the lower symmetry and weird shape of NDSCs, you will sometimes see this warning in VASP:</p>
<div class="language-text highlight"><pre><span></span><code> -----------------------------------------------------------------------------
|                                                                             |
|           W    W    AA    RRRRR   N    N  II  N    N   GGGG   !!!           |
|           W    W   A  A   R    R  NN   N  II  NN   N  G    G  !!!           |
|           W    W  A    A  R    R  N N  N  II  N N  N  G       !!!           |
|           W WW W  AAAAAA  RRRRR   N  N N  II  N  N N  G  GGG   !            |
|           WW  WW  A    A  R   R   N   NN  II  N   NN  G    G                |
|           W    W  A    A  R    R  N    N  II  N    N   GGGG   !!!           |
|                                                                             |
|     Your reciprocal lattice and k-lattice belong to different lattice       |
|     classes:                                                                |
|                                                                             |
|        The reciprocal lattice is base-centered monoclinic,                  |
|        whereas your k-lattice is triclinic.                                 |
|                                                                             |
|     Results are often still useful ...                                      |
|                                                                             |
-----------------------------------------------------------------------------
</code></pre></div>
<p>In general, this is not a problem, but it may be best to use something more efficient than Monkhorst-Pack grids for the NDSCs, such as <a href="https://github.com/msg-byu/autoGR">autoGR</a></p>
</div>
<h2 id="step-3-generate-the-force-sets-force_sets">Step 3: generate the force sets (<code>FORCE_SETS</code>)</h2>
<p>Once the DFT calcualtions are done, we will need to generate the <code>FORCE_SETS</code> files, just as we would in <code>phonopy</code>. In phonopy, we would use something like <code>phonopy disp-00{1..4}/vasprun.xml</code> to read the forces from the <code>vasprun.xml</code> for the four supercells with displacements. Here, we have five nondiagonal supercells with varying numbers of displacements each. As mentioned earlier, 
Quesadilla <strong>requires</strong> your calculations to be structured so that <code>sc-001/POSCAR-001</code> (and the resultant <code>vasprun.xml</code> or similar output file) go into the folder <code>sc-001/disp-001</code>, etc. To generate the <code>FORCE_SETS</code> for all supercells with <code>quesadilla</code>, we can run from the root directory</p>
<div class="language-bash highlight"><pre><span></span><code>quesadilla<span class="w"> </span>-f<span class="w"> </span>vasprun.xml
</code></pre></div>
<p>which is similar to running <code>phonopy -f disp-*/vasprun.xml</code> in every <code>sc-*</code> directory, generating one <code>FORCE_SETS</code> file per supercell. The output should look like
<div class="language-text highlight"><pre><span></span><code>Working on supercell 1 in directory sc-001
Found 2 displacements.
Files to extract forces from:
[&#39;disp-001/vasprun.xml&#39;, &#39;disp-002/vasprun.xml&#39;]
Calculator interface: vasp
Displacements were read from &quot;phonopy_disp.yaml&quot;.
counter (file index): 1 2
&quot;FORCE_SETS&quot; has been created.
------------------------------------
&lt;repeat until sc-005&gt;
</code></pre></div></p>
<p>If you want to use the <code>--force-sets-zero</code> option, subtracting the residual forces from the pristine supercell, then with quesadilla we'll run</p>
<div class="language-bash highlight"><pre><span></span><code>quesadilla<span class="w"> </span>--force-sets-zero<span class="w"> </span>vasprun.xml
</code></pre></div>
<p>assuming the pristine supercell calculation was done in the <code>sc-*/disp-000</code> directories as explained in the previous section.</p>
<h2 id="step-4-generate-the-force-constants">Step 4: generate the force constants</h2>
<p>Finally, we need to generate the force constants. This step is often skipped in <code>phonopy</code> and it is common to use the <code>FORCE_SETS</code> file directly. The command is (from the root directory)</p>
<p><div class="language-bash highlight"><pre><span></span><code>quesadilla<span class="w"> </span>--fc
</code></pre></div>
with output
<div class="language-text highlight"><pre><span></span><code>Forces and displacements were read from &quot;FORCE_SETS&quot;.
Force constants calculation using phonopy-traditional starts.
Max drift of force constants: 0.000001 (xx) 0.000001 (zz)
------------------------------------
&lt;repeat for all supercells&gt;
------------------------------------
Found 5 dynamical matrices at q = [0. 0. 0.]
Found 1 dynamical matrices at q = [0.25 0.   0.  ]
Found 1 dynamical matrices at q = [0.5 0.  0. ]
Found 1 dynamical matrices at q = [-0.25  0.25  0.  ]
Found 2 dynamical matrices at q = [0.5 0.5 0. ]
Found 1 dynamical matrices at q = [0.25 0.25 0.  ]
Found 1 dynamical matrices at q = [0.5  0.25 0.  ]
Found 1 dynamical matrices at q = [-0.25  0.5   0.25]
Creating the Phonopy object...
Fourier transforming the force constants back to real space...
Found 64 q-points in the full BZ
Running DynmatToForceConstants...
Applying acoustic sum rules...
</code></pre></div></p>
<p>this will produce a <code>phonopy.yaml</code> file in the root directory, containing the real space force constants for a <strong>diagonal</strong> <span class="arithmatex">\(4 \times 4 \times 4\)</span> supercell. This file can be used with <code>phonopy</code>, <code>phono3py</code>, or any other code that reads <code>phonopy.yaml</code> files.</p>
<p>For example, to plot the band structure, we could simply run, from the root directory:</p>
<div class="language-bash highlight"><pre><span></span><code>phonopy-load<span class="w"> </span>--band<span class="w"> </span>auto<span class="w"> </span>-p<span class="w"> </span>phonopy.yaml
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">What Queasdilla is doing under the hood</p>
<p>When the <code>quesadilla --fc</code> command is run, Quesadilla will read the <code>quesadilla.toml</code> file and then do the following:</p>
<ol>
<li>Read the the force sets (<code>FORCE_SETS</code>) file in each <code>sc-*</code> directory, and compute the real-space force constants for each NDSC. The results are stored in <code>sc-*/phonopy.yaml</code>, which is useful for debugging.</li>
<li>Next, for each NDSC, it will Fourier transform the real-space force constants at the <span class="arithmatex">\(q\)</span>-points each supercell is commensurate with.</li>
<li>If a <span class="arithmatex">\(q\)</span>-point is commensurate with multiple cells (such as the <span class="arithmatex">\(\Gamma\)</span> point, commensurate with all of them), the dynamical matrix is averaged. We now have the dynamical matrix at every <span class="arithmatex">\(q\)</span> point in the <em>iredducible</em> Brillouin zone.</li>
<li>Next, quesadilla will symmetrize the Fourier-transformed dynamical matrix <span class="arithmatex">\(D(q)\)</span>, using the symmetries of the little group of each q-point. This can get rid of small symmetry breaking problems that can happen in NDSCs.</li>
<li>Using the symmetrized dynamical matrices, Quesadilla will calculate the star of each q-point in the iredducible brillouin zone, then use the appropriate representations of the operators, as well as and time reversal symmetry if applicable, to compute the dynamical matrix at every point in the star of q.</li>
<li>Once this is done, we now have the dynamical matrix in the full Brillouin zone. We can now Fourier transform it to real space to obtain the force constant matrix of a diagonal 4x4x4 supercell.</li>
<li>Finally, quesadilla will apply the acoustic sum rules (ASR) to enforce translational symmetry. The final real-space IFC for the equivalent <span class="arithmatex">\(4 \times 4 \times 4\)</span> diagonal supercell is written to <code>phonopy.yaml</code> in the root directory.</li>
</ol>
<p>If you would like to learn more about how this works, I would recommend starting with the <a href="https://onlinelibrary.wiley.com/doi/10.1107/97809553602060000911/full">Chapter 2.1 of Volume D of the International Tables for Crystallography</a>.</p>
</div>
<p>We can compare the results to a standard diagonal supercell calculation</p>
<p><img alt="band structure" src="../figs/Si.png" /></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Omar A. Ashour
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.highlight", "search.share"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "develop", "provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../js/katex.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/katex.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.7/contrib/auto-render.min.js"></script>
      
    
  </body>
</html>